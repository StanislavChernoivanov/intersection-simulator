API

1. Взаимодействие с симулятором перекрестка происходит через API с помощью 
http-запросов. Отправку запросов можно осуществлять через инструмент работы с API, например - Postman. 
Реализованы 4 эндпоинта: 
    - включение светофоров на перекресте или принудительное переключение конкретного светофора 
с указанием в пути id светофора и нового цвета светофора, например - <http://localhost:8080/api/v1/intersection/traficLightColor/1?newColor=green> (метод запроса PUT);
    - получение данных обо всех светофорах (id, текущий цвет светофора, размер очереди перед светофором (авто, людей), 
время до смены сигнала). Состояние светофоров меняется в динамике. URI запроса - <http://localhost:8080/api/v1/intersection> (метод запроса GET);
    - получение данных о конкретном светофоре с указанием id в пути - <http://localhost:8080/api/v1/intersection/1> (метод запроса GET);
    - изменение продолжительности зеленого сигнала светофора вследсвие изменения (значительного уменьшения или 
значительного увеличения очеререди перед светофором). Путь выглядит так - <http://localhost:8080/api/v1/intersection/queueSize/1?queueSize=20>.


Алгоритм работы

1. Каждый светофор имеет очередь событий, которая способна ассинхронно получать события от других светофоров. Каждый 
светофор в собсвенном потоке обрабатывает событие в зависимости от того, какого рода событие и каким светофором 
направлено.
2. После отправки PUT-запроса на включение конкретного светофора (назовем его TL (traffic light)) c конкретным цветом 
(пусть будет красный) светофор TL должен сгенерировать событие и разослать его другим светофора. Остальные светофоры, 
в свою очередь, обязаны обработать событие.
В данном приложении реализовано так:
    - TL ассинхронно отправляет событие всем светофорам о том, что через 1 сек TL будет отключен, одновременно направляет 
планировщику задач новую задачу - отключить светофор TL через 1 сек. 
Остальные получают событие, обработкой которого является направление планировщику задач новой задачи - отключить текущий
светофор через 1 сек, получившего сообщение. Таким образом, через 1 сек все сигналы отключены (не рекомендуется так 
делать в час-пик);
    - затем, TL генерирует событие о запланированном включение красного сигнала светофора через 5 сек и одновременно 
отдает планировщику задач новую задачу - включить красный сигнал TL через 5 сек. Светофоры получившие событие отдают 
планировщику задач свои задачи - включить нужный цвет светофора (в зависимости от синхронности одного и того же цвета 
сигнала с TL) через 5 сек;
    - после включения красного сигнала TL отдает планировщику новую задачу - через 20 сек (default значение длительности 
зеленого сигнала) переключиться на красный сигнал и одновременно направить другим светофорам данное событие. После 
получения события, светофор, подстроившись под TL составит задачу - изменить сигнал (цвет сигнала и продолжительность 
зависят однонаправленности по отношению к TL).
    - с этого момента симулятор светофора полноценно функционирует. TL также будет направлять другим светофорам о 
запланированном переключении сигнала, а те, в свою очередь будут обрабатывать и переключаться.
3. После отправки PUT-запроса на изменение (увеличение или уменьшение) очереди перед конкретным светофором (снова TL) 
eventHandler анализирует кратность изменения очереди по отношению к зашитому default значению (по умолчанию 5). Если эта кратность 2 и 
более то TL изменит текущую продолжительность зеленого сигнала светофора по формуле 
(newDuration = currentlyDuration * ((кратность) - 1)) и одновременно направит другим светофорам событие об изменении 
продолжительности зеленого сигнал. Получив такое событие, текущий свефор подстроися под TL (если текущий светофор и TL 
смежные, тогда продолжительность зеленого сигнала тоже изменится, а если они противоположные, то все останется как было).